<div class="recent-users-card">
  <h2 class="card-title">{{title}}</h2>

  <div class="table-container">
    <table class="users-table">
      <thead>
        <tr>
          <th>User</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        @for (user of recentUser; track user.id) {
        <tr>
          <td>
            <div class="user-info" (click)="onUserClick(user.username)" style="cursor: pointer;">
              <div class="avatar">
                @if (user.profile) {
                <img [src]="'http://localhost:8080/api/files/' + user.profile" alt="{{ user.username }}" />
                } @else {
                <div class="avatar-initials">
                  {{ getInitials(user.username) }}
                </div>
                }
              </div>
              <div class="user-details">
                <span class="user-name">{{ user.name||user.username }}</span>
                <span class="user-username">{{ '@' + user.username }}</span>
              </div>
            </div>
          </td>
          <td>
            <span class="status-badge" [ngClass]="getStatusClass(user)">
              {{ getUserStatus(user) }}
            </span>
          </td>
          <td>
            <div class="actions">
              @if (user.role !== 'ADMIN') {
              <button class="action-btn ban-btn" (click)="onBanToggle(user)"
                [attr.aria-label]="user.isBaned ? 'Unban User' : 'Ban User'">
                @if (user.isBaned) {
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                  <polyline points="22 4 12 14.01 9 11.01" />
                </svg>
                } @else {
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10" />
                  <line x1="4.93" y1="4.93" x2="19.07" y2="19.07" />
                </svg>
                }
              </button>

              <button class="action-btn delete-btn" (click)="onDelete(user)" aria-label="Delete User">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="3 6 5 6 21 6" />
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                </svg>
              </button>
              } @else {
              <span class="no-actions">N/A</span>
              }
            </div>
            @if (showConfirmModal) {
            <app-confirmation-modal [message]="confirmMessage" [confirmText]="confirmButtonText"
              (confirm)="onConfirmAction()" (cancel)="showConfirmModal = false"></app-confirmation-modal>
            }
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
</div>